package com.projeto.academia.beans;

import javax.annotation.PostConstruct;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.password.PasswordEncoder;

import com.projeto.academia.model.Usuario;

public class AdminInitializerBean {
	   @Autowired
	    private UsuarioRepository usuarioRepository;

	    @Autowired
	    private PasswordEncoder passwordEncoder; // Inject a PasswordEncoder

	    @PostConstruct
	    public void createAdminUser() {
	        if (usuarioRepository.findByUsername("admin").isEmpty()) {
	            Usuario admin = new Usuario();
	            admin.setUsername("admin");
	            admin.setPassword(passwordEncoder.encode("password")); // Hash the password
	            admin.setRole("ADMIN");
	            usuarioRepository.save(admin);
	            System.out.println("Admin user created.");
	        } else {
	            System.out.println("Admin user already exists.");
	        }
	    }
}
